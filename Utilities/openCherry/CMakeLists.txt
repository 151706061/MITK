INCLUDE(CMake/PluginHelpers.cmake)

FILE(GLOB PLUGIN_DIRS *)
LIST(REMOVE_ITEM PLUGIN_DIRS "${CMAKE_CURRENT_SOURCE_DIR}/CVS" "${CMAKE_CURRENT_SOURCE_DIR}/.svn")

OPTION(BUILD_ALL_PLUGINS "Build all plugins (overriding selection)")
MARK_AS_ADVANCED(BUILD_ALL_PLUGINS)

OPTION(CHERRY_STATIC "Build all plugins as static libraries" OFF)
MARK_AS_ADVANCED(CHERRY_STATIC)

SET(PLUGIN_DIR ${CMAKE_CURRENT_SOURCE_DIR})

INCLUDE(${QT_USE_FILE})

INCLUDE_DIRECTORIES(${PLUGIN_DIR})

FOREACH(d ${PLUGIN_DIRS})
  IF(IS_DIRECTORY ${d})
  IF(EXISTS ${d}/CMakeLists.txt)
    MESSAGE(STATUS "Processing ${d}")
    ADD_SUBDIRECTORY(${d})
    # GET_DIRECTORY_PROPERTY(PROP DIRECTORY ${d} DEFINITION FUNC_NAME)
  ELSE(EXISTS ${d}/CMakeLists.txt)
    MESSAGE("Plugin dir ${d} doesn't contain a CMakeLists.txt file")
  ENDIF(EXISTS ${d}/CMakeLists.txt)
  ENDIF(IS_DIRECTORY ${d})
ENDFOREACH(d)

