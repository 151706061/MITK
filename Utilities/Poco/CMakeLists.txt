SET(CMAKE_DEBUG_POSTFIX d)

SET(Poco_INCLUDE_DIR
    "${CMAKE_CURRENT_SOURCE_DIR}"
    CACHE PATH
    "top-level directory containing the poco include directories. E.g /usr/local/include/ or c:\\poco\\include\\poco-1.3.2")

SET(Poco_LIBRARY_DIR
    "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}"
    CACHE PATH
    "top-level directory containing the poco libraries.")

# POCO relies on the flags _DEBUG and NDEBUG to be set accordingly.
# These are Microsoft specific flags and not automatically defined by gcc or
# others, so we have to define them by ourselves.
IF(CMAKE_BUILD_TYPE)

  STRING(TOUPPER ${CMAKE_BUILD_TYPE} buildtype)
  IF(buildtype STREQUAL "DEBUG")
    SET(DEBUG_FLAG "-D_DEBUG")
  ELSE(buildtype STREQUAL "DEBUG")
    SET(DEBUG_FLAG "-DNDEBUG")
  ENDIF(buildtype STREQUAL "DEBUG")

ELSE(CMAKE_BUILD_TYPE)

  #SET(DEBUG_FLAG "-D_DEBUG")
  #default build type is release
  
ENDIF(CMAKE_BUILD_TYPE)

#SET(POCO_UNIX_COMPILE_FLAGS "-D_XOPEN_SOURCE=500 -D_REENTRANT -D_THREAD_SAFE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE ${DEBUG_FLAG} -w")
IF(APPLE)
  SET(POCO_UNIX_COMPILE_FLAGS "-D_XOPEN_SOURCE=500 -D_REENTRANT -D_THREAD_SAFE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE ${DEBUG_FLAG} -w -D_DARWIN_C_SOURCE -DPOCO_HAVE_IPv6")
ELSE(APPLE)
  SET(POCO_UNIX_COMPILE_FLAGS "-D_XOPEN_SOURCE=500 -D_REENTRANT -D_THREAD_SAFE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE ${DEBUG_FLAG} -w")
ENDIF(APPLE)

SET(POCO_UNIX_COMPILE_FLAGS "${POCO_UNIX_COMPILE_FLAGS}")

SET(Poco_BUILD_TESTSUITES OFF CACHE BOOL "Build the Poco testsuites")
MARK_AS_ADVANCED(Poco_BUILD_TESTSUITES)

ADD_SUBDIRECTORY(Foundation)
ADD_SUBDIRECTORY(XML)
ADD_SUBDIRECTORY(Util)

IF(Poco_BUILD_TESTSUITES)
  ADD_SUBDIRECTORY(CppUnit)
ENDIF(Poco_BUILD_TESTSUITES)

